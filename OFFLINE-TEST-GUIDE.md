# 오프라인 기능 테스트 가이드

## 🔧 현재 구현된 오프라인 기능

### ✅ Service Worker 설정
- **자동 업데이트**: 새 버전 감지 시 사용자에게 알림
- **캐싱 전략**: 
  - App Shell (HTML, CSS, JS) - 즉시 캐시
  - 이미지 파일 - CacheFirst (30일)
  - Google Fonts - CacheFirst (1년)
- **오프라인 폴백**: 네비게이션 요청 시 index.html 제공

### ✅ 오프라인 감지
- **실시간 모니터링**: 네트워크 상태 변화 감지
- **사용자 알림**: 오프라인 시 상단 배너 표시
- **연결 재시도**: 수동/자동 재연결 시도

### ✅ PWA 업데이트
- **자동 감지**: 새 Service Worker 버전 탐지
- **사용자 선택**: 업데이트 적용 여부 선택 가능
- **부드러운 업데이트**: 새로고침 없는 업데이트

## 🧪 테스트 방법

### 1. 기본 오프라인 테스트

#### Chrome DevTools 사용
1. **개발자 도구 열기** (F12)
2. **Application 탭** 이동
3. **Service Workers** 섹션 확인
4. **Network 탭** → **Offline** 체크박스 선택
5. 앱 기능 테스트

#### 실제 네트워크 테스트
1. WiFi/인터넷 연결 끊기
2. 앱 새로고침 시도
3. 기본 기능 작동 확인

### 2. Service Worker 캐싱 테스트

```bash
# 1. 프로덕션 빌드
npm run build

# 2. 프리뷰 서버 실행
npm run preview

# 3. 브라우저에서 접속
# http://localhost:4173
```

#### 확인할 항목들
- ✅ **첫 방문**: 모든 리소스 로드 및 캐시 저장
- ✅ **두 번째 방문**: 캐시된 리소스에서 빠른 로드
- ✅ **오프라인 상태**: 캐시된 앱 정상 작동
- ✅ **업데이트 후**: 새 버전 감지 및 업데이트 프롬프트

### 3. 상세 테스트 시나리오

#### 시나리오 1: 첫 방문 → 오프라인 → 재접속
1. 앱 첫 방문 (Service Worker 등록)
2. 새로고침으로 캐시 확인
3. 오프라인 모드 활성화
4. 앱 기능 테스트
5. 온라인 복구 시 알림 확인

#### 시나리오 2: 앱 업데이트 테스트
1. 코드 수정 후 재빌드
2. 기존 앱에서 업데이트 감지 확인
3. 업데이트 프롬프트 표시 확인
4. 업데이트 적용 테스트

#### 시나리오 3: 장기간 오프라인 사용
1. 완전한 네트워크 차단
2. 앱의 모든 페이지 이동 테스트
3. 설정 변경 및 저장 확인
4. 시간 표시 기능 작동 확인

## 📊 Chrome DevTools에서 확인할 지표

### Application 탭
- **Service Workers**: 등록 상태, 버전, 업데이트
- **Storage**: 캐시된 파일 목록 및 크기
- **Manifest**: PWA 매니페스트 정보

### Network 탭
- **Cache Hit**: 캐시에서 로드된 리소스 확인
- **Offline Simulation**: 오프라인 상태 시뮬레이션
- **Throttling**: 느린 네트워크 환경 테스트

### Lighthouse 탭
- **PWA 점수**: 오프라인 지원 점수 확인
- **Performance**: 캐시 효과로 인한 성능 개선
- **Best Practices**: PWA 모범 사례 준수

## 🔍 예상 동작

### 정상 작동 시
```
✅ Service Worker 등록됨
✅ 앱 shell 캐시됨 (HTML, CSS, JS)
✅ 이미지 파일 캐시됨
✅ 오프라인 상태에서 앱 로드 가능
✅ 설정 데이터 localStorage에 유지
✅ 시간 표시 기능 작동 (로컬 시간)
✅ 네트워크 복구 시 자동 감지
```

### 문제 발생 시 체크포인트
```
❌ Service Worker 등록 실패
   → 브라우저 호환성 확인
   → HTTPS 환경 필요 (프로덕션)

❌ 캐시 누락
   → Workbox 설정 확인
   → 파일 경로 문제 확인

❌ 오프라인에서 앱 로드 실패
   → navigateFallback 설정 확인
   → 캐시 정책 확인
```

## ⚡ 성능 최적화 확인

### 캐시 효율성
- **첫 로드**: ~600KB (전체 다운로드)
- **재방문**: ~50KB 미만 (업데이트된 파일만)
- **오프라인**: 0KB (완전 캐시 활용)

### 로딩 시간
- **온라인 재방문**: < 1초
- **오프라인 시작**: < 0.5초
- **페이지 이동**: 즉시

## 🚨 알려진 제한사항

### 1. 시간 동기화
- 오프라인에서는 로컬 시간만 사용
- 시간대 변경 감지 불가
- GPS 위치 업데이트 불가

### 2. 광고 표시
- 오프라인에서는 광고 로드 실패
- AdSense 스크립트 로드 불가

### 3. 설정 동기화
- 설정은 로컬 저장소에만 저장
- 다른 기기와 동기화 불가

## 📈 개선 계획

### 향후 추가 예정
- **백그라운드 동기화**: 온라인 복구 시 데이터 동기화
- **푸시 알림**: 중요 업데이트 알림
- **오프라인 분석**: 사용 패턴 추적 (온라인 복구 시 전송)